<!-- Author: Ahmed Abdullah (2025) - Clean rewrite -->
{% extends "base.html" %}

{% block content %}
    <div class="card">
        <h1>User Profile</h1>
        
        <div class="profile-header" style="display: flex; align-items: center; gap: 2rem; margin-bottom: 2rem;">
            <div class="profile-photo">
                {% if user[5] %}
                    <img src="{{ url_for('static', filename='uploads/' + user[5]) }}" 
                         alt="Profile Photo" 
                         style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover;">
                {% else %}
                    <img src="{{ url_for('misc.get_image') }}?image=default-profile.png" 
                         alt="Default Profile"
                         style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover;">
                {% endif %}
            </div>
            <div class="profile-info">
                <p><strong>Username:</strong> {{ user[1] }}</p>
                <p><strong>Email:</strong> {{ user[2] }}</p>
                <p><strong>Phone:</strong> {{ user[4] }}</p>
            </div>
        </div>
        <div class="d-flex justify-content-end gap-2">
            <a href="{{ url_for('post.my_posts') }}?username={{ user[1] }}" class="btn btn-outline-primary">
                <i class="fas fa-eye"></i> View My Posts
            </a>
            {% if user[1] == 'admin' %}
                <a href="{{ url_for('user.manage_users') }}" class="btn btn-danger">
                    <i class="fas fa-users"></i> Manage Users
                </a>
            {% endif %}
        </div>
    </div>

    <div class="card">
        <h2>Change Password</h2>
        <form method="POST" action="{{ url_for('dashboard.change_password') }}">
            <div class="form-group">
                <label for="new_password">New Password</label>
                <input type="password" id="new_password" name="new_password" required>
            </div>
            <button type="submit"><i class="fas fa-key"></i> Change Password</button>
        </form>
    </div>

    <div class="card">
        <h2>Update Profile Photo</h2>
        <form method="POST" action="{{ url_for('dashboard.upload_file') }}" enctype="multipart/form-data">
            <div class="form-group">
                <input type="file" name="file" accept="image/*" required>
            </div>
            <button type="submit" class="btn">Upload Photo</button>
        </form>
    </div>

{% endblock %}
